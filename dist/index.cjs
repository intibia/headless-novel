'use client'
var fe=Object.create;var x=Object.defineProperty;var ge=Object.getOwnPropertyDescriptor;var Ee=Object.getOwnPropertyNames;var he=Object.getPrototypeOf,ye=Object.prototype.hasOwnProperty;var Ce=(t,e)=>{for(var r in e)x(t,r,{get:e[r],enumerable:!0})},A=(t,e,r,o)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of Ee(e))!ye.call(t,n)&&n!==r&&x(t,n,{get:()=>e[n],enumerable:!(o=ge(e,n))||o.enumerable});return t};var p=(t,e,r)=>(r=t!=null?fe(he(t)):{},A(e||!t||!t.__esModule?x(r,"default",{value:t,enumerable:!0}):r,t)),xe=t=>A(x({},"__esModule",{value:!0}),t);var ke={};Ce(ke,{EditorBubble:()=>re,EditorBubbleItem:()=>L,EditorCommand:()=>$,EditorCommandEmpty:()=>ce,EditorCommandItem:()=>w,EditorContent:()=>te,EditorRoot:()=>ee,defaultEditorProps:()=>oe,useEditor:()=>ue.useCurrentEditor});module.exports=xe(ke);var ue=require("@tiptap/react"),mt=require("@tiptap/core");var R=require("react"),j=require("@tiptap/react"),D=require("jotai");var Ie=p(require("@tiptap/starter-kit"),1),_=p(require("@tiptap/extension-horizontal-rule"),1),He=p(require("@tiptap/extension-link"),1),Me=p(require("@tiptap/extension-image"),1),z=p(require("@tiptap/extension-placeholder"),1),X=p(require("@tiptap/extension-underline"),1),q=p(require("@tiptap/extension-text-style"),1),F=require("@tiptap/extension-color"),J=require("tiptap-markdown"),Y=p(require("@tiptap/extension-highlight"),1);var B=require("@tiptap/core"),Pe=B.Extension.create({name:"CustomKeymap",addCommands(){return{selectTextWithinNodeBoundaries:()=>({editor:t,commands:e})=>{let{state:r}=t,{tr:o}=r,n=o.selection.$from.start(),i=o.selection.$to.end();return e.setTextSelection({from:n,to:i})}}},addKeyboardShortcuts(){return{"Mod-a":({editor:t})=>{let{state:e}=t,{tr:r}=e,o=r.selection.from,n=r.selection.to,i=r.selection.$from.start(),a=r.selection.$to.end();return o>i||n<a?(t.chain().selectTextWithinNodeBoundaries().run(),!0):!1}}}}),k=Pe;var W=require("@tiptap/core"),y=require("@tiptap/pm/state"),K=require("@tiptap/pm/view");function be(t){let e=t.getBoundingClientRect();return{top:e.top,left:e.left,width:e.width}}function T(t){return document.elementsFromPoint(t.x,t.y).find(e=>e.parentElement?.matches?.(".ProseMirror")||e.matches(["li","p:not(:first-child)","pre","blockquote","h1, h2, h3, h4, h5, h6"].join(", ")))}function v(t,e,r){let o=t.getBoundingClientRect();return e.posAtCoords({left:o.left+50+r.dragHandleWidth,top:o.top+1})?.inside}function Re(t){function e(a,d){if(d.focus(),!a.dataTransfer)return;let s=T({x:a.clientX+50+t.dragHandleWidth,y:a.clientY});if(!(s instanceof Element))return;let l=v(s,d,t);if(l==null||l<0)return;d.dispatch(d.state.tr.setSelection(y.NodeSelection.create(d.state.doc,l)));let m=d.state.selection.content(),{dom:f,text:c}=(0,K.__serializeForClipboard)(d,m);a.dataTransfer.clearData(),a.dataTransfer.setData("text/html",f.innerHTML),a.dataTransfer.setData("text/plain",c),a.dataTransfer.effectAllowed="copyMove",a.dataTransfer.setDragImage(s,0,0),d.dragging={slice:m,move:a.ctrlKey}}function r(a,d){d.focus(),d.dom.classList.remove("dragging");let s=T({x:a.clientX+50+t.dragHandleWidth,y:a.clientY});if(!(s instanceof Element))return;let l=v(s,d,t);l&&d.dispatch(d.state.tr.setSelection(y.NodeSelection.create(d.state.doc,l)))}let o=null;function n(){o&&o.classList.add("hide")}function i(){o&&o.classList.remove("hide")}return new y.Plugin({view:a=>(o=document.createElement("div"),o.draggable=!0,o.dataset.dragHandle="",o.classList.add("drag-handle"),o.addEventListener("dragstart",d=>{e(d,a)}),o.addEventListener("click",d=>{r(d,a)}),n(),a?.dom?.parentElement?.appendChild(o),{destroy:()=>{o?.remove?.(),o=null}}),props:{handleDOMEvents:{mousemove:(a,d)=>{if(!a.editable)return;let s=T({x:d.clientX+50+t.dragHandleWidth,y:d.clientY});if(!(s instanceof Element)){n();return}let l=window.getComputedStyle(s),m=parseInt(l.lineHeight,10),f=parseInt(l.paddingTop,10),c=be(s);c.top+=(m-24)/2,c.top+=f,s.matches("ul:not([data-type=taskList]) li, ol li")&&(c.left-=t.dragHandleWidth),c.width=t.dragHandleWidth,o&&(o.style.left=`${c.left-c.width}px`,o.style.top=`${c.top}px`,i())},keydown:()=>{n()},mousewheel:()=>{n()},dragstart:a=>{a.dom.classList.add("dragging")},drop:a=>{a.dom.classList.remove("dragging")},dragend:a=>{a.dom.classList.remove("dragging")}}}})}var De=W.Extension.create({name:"dragAndDrop",addProseMirrorPlugins(){return[Re({dragHandleWidth:24})]}}),O=De;var Ne=require("@tiptap/extension-task-item"),Le=require("@tiptap/extension-task-list"),Q=require("@tiptap/core");var E=require("jotai"),C=require("react"),U=p(require("tunnel-rat"),1);var P=require("cmdk"),g=require("react/jsx-runtime"),Se=(0,U.default)(),Te=(0,E.atom)(""),V=(0,E.atom)(null);var $=(0,C.forwardRef)(({children:t,className:e,...r},o)=>{let n=(0,C.useRef)(null),[i,a]=(0,E.useAtom)(Te);return(0,g.jsx)(Se.In,{children:(0,g.jsxs)(P.Command,{ref:o,onKeyDown:d=>{d.stopPropagation()},id:"slash-command",className:e,...r,children:[(0,g.jsx)(P.Command.Input,{value:i,onValueChange:a,style:{display:"none"}}),(0,g.jsx)(P.Command.List,{ref:n,children:t})]})})});var _e=z.default.configure({placeholder:({node:t})=>t.type.name==="heading"?`Heading ${t.attrs.level}`:"Press '/' for commands",includeChildren:!0}),G=[X.default,q.default,F.Color,Y.default.configure({multicolor:!0}),J.Markdown.configure({html:!1,transformCopiedText:!0}),k,O],ze=_.default.extend({addInputRules(){return[new Q.InputRule({find:/^(?:---|â€”-|___\s|\*\*\*\s)$/,handler:({state:t,range:e})=>{let r={},{tr:o}=t,n=e.from,i=e.to;o.insert(n-1,this.type.create(r)).delete(o.mapping.map(n),o.mapping.map(i))}})]}});var H=require("@tiptap/pm/state"),Z=require("@tiptap/pm/view"),I=new H.PluginKey("upload-image");function we(t,e){let o=I.getState(t).find(null,null,n=>n.id==e);return o.length?o[0].from:null}function M(t,e,r){if(t.type.includes("image/")){if(t.size/1024/1024>20)return}else return;let o={},n=e.state.tr;n.selection.empty||n.deleteSelection();let i=new FileReader;i.readAsDataURL(t),i.onload=()=>{n.setMeta(I,{add:{id:o,pos:r,src:i.result}}),e.dispatch(n)},Ae(t).then(a=>{let{schema:d}=e.state,s=we(e.state,o);if(s==null)return;let l=typeof a=="object"?i.result:a,m=d.nodes.image.create({src:l}),f=e.state.tr.replaceWith(s,s,m).setMeta(I,{remove:{id:o}});e.dispatch(f)})}var Ae=t=>{};var tt=require("@tiptap/core"),b=require("react/jsx-runtime"),Be=(0,D.createStore)(),ee=({children:t})=>(0,b.jsx)(D.Provider,{store:Be,children:t}),te=(0,R.forwardRef)(({className:t,children:e,initialContent:r,...o},n)=>{let i=(0,R.useMemo)(()=>[...G,...o.extensions??[]],[o.extensions]);return(0,b.jsx)("div",{ref:n,className:t,children:(0,b.jsx)(j.EditorProvider,{...o,content:r,extensions:i,children:e})})}),oe={handleDOMEvents:{keydown:(t,e)=>{if(["ArrowUp","ArrowDown","Enter"].includes(e.key)&&document.querySelector("#slash-command"))return!0}},handlePaste:(t,e)=>{if(e.clipboardData&&e.clipboardData.files&&e.clipboardData.files[0]){e.preventDefault();let r=e.clipboardData.files[0],o=t.state.selection.from;return M(r,t,o),!0}return!1},handleDrop:(t,e,r,o)=>{if(!o&&e.dataTransfer&&e.dataTransfer.files&&e.dataTransfer.files[0]){e.preventDefault();let n=e.dataTransfer.files[0],i=t.posAtCoords({left:e.clientX,top:e.clientY});return M(n,t,i?.pos||-1),!0}return!1}};var h=require("@tiptap/react"),u=require("react"),N=require("react/jsx-runtime"),re=(0,u.forwardRef)(({children:t,tippyOptions:e,...r},o)=>{let{editor:n}=(0,h.useCurrentEditor)(),i=(0,u.useRef)(null);(0,u.useEffect)(()=>{!i.current||!e?.placement||(i.current.setProps({placement:e.placement}),i.current.popperInstance?.update())},[e?.placement]);let a=(0,u.useMemo)(()=>({shouldShow:({editor:s,state:l})=>{let{selection:m}=l,{empty:f}=m;return!(s.isActive("image")||f||(0,h.isNodeSelection)(m))},tippyOptions:{onCreate:s=>{i.current=s},moveTransition:"transform 0.15s ease-out",...e},...r}),[r,e]);return n?(0,N.jsx)("div",{ref:o,children:(0,N.jsx)(h.BubbleMenu,{editor:n,...a,children:t})}):null});var ne=require("react"),ae=require("@radix-ui/react-slot"),ie=require("@tiptap/react"),de=require("react/jsx-runtime"),L=(0,ne.forwardRef)(({children:t,asChild:e,onSelect:r,...o},n)=>{let{editor:i}=(0,ie.useCurrentEditor)(),a=e?ae.Slot:"div";return i?(0,de.jsx)(a,{ref:n,...o,onClick:()=>r?.(i),children:t}):null});L.displayName="EditorBubbleItem";var se=require("react"),S=require("cmdk"),it=require("@tiptap/core"),le=require("@tiptap/react"),me=require("jotai");var pe=require("react/jsx-runtime"),w=(0,se.forwardRef)(({children:t,onCommand:e,...r},o)=>{let{editor:n}=(0,le.useCurrentEditor)(),i=(0,me.useAtomValue)(V);return!n||!i?null:(0,pe.jsx)(S.CommandItem,{ref:o,...r,onSelect:()=>e({editor:n,range:i}),children:t})});w.displayName="EditorCommandItem";var ce=S.CommandEmpty;0&&(module.exports={EditorBubble,EditorBubbleItem,EditorCommand,EditorCommandEmpty,EditorCommandItem,EditorContent,EditorRoot,defaultEditorProps,useEditor});
